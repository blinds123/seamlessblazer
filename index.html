<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5">
<title>Seamless Blazer - Limited Drop</title>
<meta name="description" content="The viral seamless blazer everyone's obsessed with. Professional styling, buttery-smooth fabric, zero awkward seams. Ships worldwide. 30-day returns.">

<!-- TikTok Pixel Code -->
<script>
!function (w, d, t) {
  w.TiktokAnalyticsObject=t;var ttq=w[t]=w[t]||[];ttq.methods=["page","track","identify","instances","debug","on","off","once","ready","alias","group","enableCookie","disableCookie"],ttq.setAndDefer=function(t,e){t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}};for(var i=0;i<ttq.methods.length;i++)ttq.setAndDefer(ttq,ttq.methods[i]);ttq.instance=function(t){for(var e=ttq._i[t]||[],n=0;n<ttq.methods.length;n++)ttq.setAndDefer(e,ttq.methods[n]);return e},ttq.load=function(e,n){var i="https://analytics.tiktok.com/i18n/pixel/events.js";ttq._i=ttq._i||{},ttq._i[e]=[],ttq._i[e]._u=i,ttq._t=ttq._t||{},ttq._t[e]=+new Date,ttq._o=ttq._o||{},ttq._o[e]=n||{};var o=document.createElement("script");o.type="text/javascript",o.async=!0,o.src=i+"?sdkid="+e+"&lib="+t;var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(o,a)};
  ttq.load('D3CVHNBC77U2RE92M7O0');
  ttq.page();
  ttq.track('ViewContent', {
    content_id: 'seamless-blazer',
    content_type: 'product',
    content_name: 'Seamless Blazer',
    price: 59,
    currency: 'USD',
    value: 59
  });
}(window, document, 'ttq');
</script>
<!-- End TikTok Pixel Code -->

<!-- Performance Meta -->
<meta name="theme-color" content="#4a3728">
<meta name="color-scheme" content="light">

<!-- Critical Resource Hints -->
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="dns-prefetch" href="//analytics.google.com">

<!-- Preload Critical Hero Image -->
<link rel="preload" as="image" href="./images/product/product-01.jpeg" type="image/jpeg" fetchpriority="high">

<!-- Critical CSS - Ultra-Minimal -->
<style>
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent}
body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Oxygen,Ubuntu,Cantarell,sans-serif;color:#2a2420;line-height:1.6;background:#faf8f5;-webkit-font-smoothing:antialiased;overflow-x:hidden}

/* Main Page Styles - No Quiz Version */
.main-content{display:block}
.announcement{background:#4a3728;color:#faf8f5;text-align:center;padding:12px;font-size:14px;font-weight:500;position:relative;z-index:10}
.container{max-width:1200px;margin:0 auto;padding:0 20px;position:relative}
.product-hero{display:grid;grid-template-columns:1fr 1fr;gap:60px;padding:40px 20px;align-items:start;min-height:500px}
.gallery{position:sticky;top:20px;z-index:1}
.main-img{width:100%;height:auto;border-radius:16px;aspect-ratio:3/4;object-fit:cover;background:#f5f3f0;will-change:transform;transition:opacity 0.3s ease;box-shadow:0 4px 20px rgba(74,55,40,0.08)}
.product-info{position:relative;z-index:2}
.product-info h1{font-size:clamp(28px,5vw,40px);font-weight:700;margin-bottom:10px;line-height:1.2;letter-spacing:-0.02em;color:#2a2420}
.tagline{color:#6b5d52;font-size:clamp(16px,3vw,18px);margin-bottom:20px;font-weight:400}
.price-box{display:flex;align-items:baseline;gap:15px;margin-bottom:30px;flex-wrap:wrap}
.price{font-size:clamp(28px,6vw,36px);font-weight:700;color:#2a2420;letter-spacing:-0.02em}
.old-price{font-size:clamp(20px,4vw,24px);color:#a89c91;text-decoration:line-through}
.badge{background:#c87855;color:#faf8f5;padding:4px 12px;border-radius:20px;font-size:14px;font-weight:600;white-space:nowrap}
.cta-btn{width:100%;padding:18px;font-size:18px;font-weight:700;border-radius:12px;border:none;cursor:pointer;margin-bottom:15px;transition:all 0.15s cubic-bezier(0.4,0,0.2,1);transform:translateZ(0);will-change:transform;position:relative;overflow:hidden}
.cta-btn::before{content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,0.2),transparent);transition:left 0.5s;z-index:1}
.cta-btn:hover::before{left:100%}
.cta-primary{background:#4a3728;color:#faf8f5;box-shadow:0 4px 16px rgba(74,55,40,0.15)}
.cta-primary:hover{transform:translateY(-2px);box-shadow:0 6px 24px rgba(74,55,40,0.25)}
.cta-primary:active{transform:translateY(0) scale(0.98)}
.btn-subtitle{font-size:12px;font-weight:400;opacity:0.9;margin-top:4px;position:relative;z-index:2}
.fade-in{opacity:0;transform:translateY(20px);transition:opacity 0.6s ease,transform 0.6s ease}
.fade-in.visible{opacity:1;transform:translateY(0)}

/* Testimonial Styles - FULL-WIDTH IMAGES */
.testimonial-card{background:#faf8f5;border-radius:16px;padding:24px;box-shadow:0 2px 12px rgba(74,55,40,0.08);border:1px solid #ede8e3}
.testimonial-header{display:flex;align-items:center;gap:12px;margin-bottom:16px}
.testimonial-avatar{width:48px;height:48px;border-radius:50%;object-fit:cover}
.testimonial-info{flex:1}
.testimonial-name{font-weight:600;font-size:14px;margin-bottom:2px;color:#2a2420}
.testimonial-platform{display:flex;align-items:center;gap:6px;color:#6b5d52;font-size:12px}
.testimonial-platform svg{width:14px;height:14px}
.testimonial-stars{color:#c87855;font-size:14px;letter-spacing:2px}
.testimonial-text{font-size:15px;line-height:1.6;color:#3d352e;margin-bottom:16px}
.testimonial-date{color:#a89c91;font-size:12px;margin-top:12px}
.testimonial-photo{width:100%;height:auto;border-radius:12px;margin-top:16px;object-fit:cover;aspect-ratio:4/5}

/* Accordion Styles */
.accordion-item{border-bottom:1px solid #ede8e3}
.accordion-header{width:100%;background:none;border:none;padding:20px 0;display:flex;justify-content:space-between;align-items:center;cursor:pointer;text-align:left;font-size:18px;font-weight:600;transition:all 0.2s;color:#2a2420}
.accordion-header:hover{color:#4a3728}
.accordion-icon{transition:transform 0.3s ease;font-size:20px;color:#8b7355}
.accordion-content{max-height:0;overflow:hidden;transition:max-height 0.3s ease,padding 0.3s ease;padding:0 0}
.accordion-content.active{max-height:500px;padding:0 0 20px 0}
.accordion-header.active .accordion-icon{transform:rotate(180deg)}

/* Size Selector */
.size-btn{padding:14px 12px;border:2px solid #ede8e3;background:#faf8f5;border-radius:10px;cursor:pointer;font-weight:600;transition:all 0.2s;font-size:14px;color:#2a2420}
.size-btn:not(:disabled):hover{border-color:#4a3728;transform:scale(1.05)}
.size-btn.selected{background:#4a3728;color:#faf8f5;border-color:#4a3728}
.size-btn:disabled{opacity:0.4;cursor:not-allowed}

/* Mobile Responsive */
@media(max-width:768px){
.product-hero{grid-template-columns:1fr;gap:30px;padding:20px 16px}
.gallery{position:static}
.container{padding:0 16px}
.cta-btn{font-size:16px;padding:16px;min-height:56px}
.size-btn{min-width:44px;min-height:44px;font-size:13px}
.accordion-header{font-size:16px;padding:16px 0}
.accordion-content{font-size:14px}
.testimonial-card{padding:20px}
.testimonial-photo{aspect-ratio:3/4}
}

@keyframes fadeIn{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
@keyframes pulse{0%,100%{box-shadow:0 0 0 0 rgba(74,55,40,0.4)}50%{box-shadow:0 0 0 10px rgba(74,55,40,0)}}

/* Scarcity Popup - Premium Toast Style */
.scarcity-popup{position:fixed;top:20px;left:50%;transform:translateX(-50%) translateY(-100px);background:#faf8f5;padding:16px 24px;border-radius:12px;box-shadow:0 8px 32px rgba(74,55,40,0.15);display:flex;align-items:center;gap:12px;z-index:9999;opacity:0;transition:all 0.4s cubic-bezier(0.4,0,0.2,1);max-width:90vw;border:1px solid #ede8e3}
.scarcity-popup.show{opacity:1;transform:translateX(-50%) translateY(0)}
.scarcity-popup.hide{opacity:0;transform:translateX(-50%) translateY(-100px)}
.scarcity-icon{width:40px;height:40px;border-radius:50%;background:linear-gradient(135deg,#c87855 0%,#d89570 100%);display:flex;align-items:center;justify-content:center;flex-shrink:0}
.scarcity-content{flex:1;min-width:0}
.scarcity-title{font-weight:700;font-size:15px;color:#2a2420;margin:0 0 2px 0}
.scarcity-subtitle{font-size:13px;color:#6b5d52;margin:0}

@media(max-width:768px){
.scarcity-popup{top:10px;padding:14px 20px}
.scarcity-icon{width:36px;height:36px}
.scarcity-title{font-size:14px}
.scarcity-subtitle{font-size:12px}
}
</style>

<!-- Prefetch Additional Images -->
<link rel="prefetch" as="image" href="./images/product/product-02.jpeg">
<link rel="prefetch" as="image" href="./images/product/product-03.jpeg">
</head>

<body>

<!-- Scarcity Popup -->
<div id="scarcityPopup" class="scarcity-popup">
  <div class="scarcity-icon">
    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#fff" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
      <path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/>
    </svg>
  </div>
  <div class="scarcity-content">
    <div class="scarcity-title">XL just sold out!</div>
    <div class="scarcity-subtitle">Someone grabbed the last one</div>
  </div>
</div>

<!-- Order Bump Popup -->
<div id="orderBumpPopup" style="display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(42,36,32,0.8);z-index:10000;align-items:center;justify-content:center;padding:20px">
  <div style="background:#faf8f5;border-radius:16px;max-width:600px;width:100%;padding:40px;position:relative;box-shadow:0 20px 60px rgba(74,55,40,0.3);animation:fadeIn 0.3s ease">
    <button onclick="closeOrderBumpPopup()" style="position:absolute;top:20px;right:20px;background:none;border:none;font-size:28px;cursor:pointer;color:#a89c91;line-height:1;padding:0;width:32px;height:32px">&times;</button>
    <div style="text-align:center;margin-bottom:30px">
      <div style="background:#4a3728;color:#faf8f5;display:inline-block;padding:8px 16px;border-radius:20px;font-size:14px;font-weight:700;margin-bottom:20px">COMPLETE THE LOOK!</div>
      <h2 style="font-size:28px;font-weight:700;margin-bottom:12px;color:#2a2420">Add the Silk Pocket Square?</h2>
      <p style="color:#6b5d52;font-size:16px">The perfect finishing touch to complete your blazer</p>
    </div>
    <div style="background:#f5f3f0;border-radius:12px;padding:24px;margin-bottom:30px">
      <div style="display:flex;gap:20px;align-items:center">
        <div style="flex:1">
          <h3 style="font-size:20px;font-weight:700;margin-bottom:8px;color:#2a2420">Premium Silk Pocket Square</h3>
          <ul style="list-style:none;padding:0;margin:0">
            <li style="margin:6px 0;color:#6b5d52;font-size:14px">Matching professional colorway</li>
            <li style="margin:6px 0;color:#6b5d52;font-size:14px">100% premium silk fabric</li>
            <li style="margin:6px 0;color:#6b5d52;font-size:14px">Hand-rolled edges</li>
            <li style="margin:6px 0;color:#6b5d52;font-size:14px">Elevate your blazer instantly</li>
          </ul>
        </div>
        <div style="text-align:center">
          <div style="font-size:14px;color:#a89c91;text-decoration:line-through">$29</div>
          <div style="font-size:32px;font-weight:700;color:#87a878">$10</div>
          <div style="background:#87a878;color:#faf8f5;padding:4px 12px;border-radius:12px;font-size:12px;font-weight:700;margin-top:8px">66% OFF</div>
        </div>
      </div>
    </div>
    <div id="orderSummary" style="background:#faf8f5;border:2px solid #ede8e3;border-radius:12px;padding:20px;margin-bottom:24px">
      <!-- Dynamic order summary -->
    </div>
    <button onclick="acceptOrderBump()" style="width:100%;background:#87a878;color:#faf8f5;border:none;padding:18px;border-radius:12px;font-size:18px;font-weight:700;cursor:pointer;margin-bottom:12px;transition:all 0.2s">
      YES! Add Pocket Square - Only $10
    </button>
    <button onclick="declineOrderBump()" style="width:100%;background:#faf8f5;color:#6b5d52;border:2px solid #ede8e3;padding:14px;border-radius:12px;font-size:14px;font-weight:600;cursor:pointer;transition:all 0.2s">
      No thanks, just the blazer
    </button>
  </div>
</div>

<!-- Main Content -->
<div class="main-content" id="mainContent">
  <div class="announcement">THE BLAZER EVERYONE'S OBSESSED WITH - NOW RESTOCKED</div>

  <div class="container">
    <div class="product-hero">
      <div class="gallery">
        <img class="main-img fade-in visible" id="heroImage" src="./images/product/product-01.jpeg" alt="Seamless Blazer" width="600" height="800" loading="eager" decoding="async">
        <div id="thumbs" style="display:flex;gap:10px;margin-top:15px;overflow-x:auto"></div>
      </div>

      <div class="product-info">
        <h1 class="fade-in visible">The Seamless Blazer That Has Everyone Asking 'Where'd You Get That?'</h1>
        <p class="tagline fade-in visible">The blazer that tricks everyone into thinking you spent $400</p>

        <div class="price-box fade-in visible">
          <span class="price">$59</span>
          <span class="old-price">$99</span>
          <span class="badge">40% OFF</span>
        </div>
        <div style="color:#c87855;font-size:14px;font-weight:600;margin-bottom:24px">2,847 sold in the last 48 hours</div>

        <!-- SIZE SELECTOR MOVED HERE - ABOVE CTAs -->
        <div style="margin-bottom:24px">
          <h3 style="margin-bottom:12px;font-weight:600;font-size:16px;color:#2a2420">Select Your Size:</h3>
          <div style="display:grid;grid-template-columns:repeat(6,1fr);gap:10px;margin-bottom:16px">
            <button class="size-btn" data-size="XS" onclick="selectSize(this, 'XS')">XS</button>
            <button class="size-btn" data-size="S" onclick="selectSize(this, 'S')">S</button>
            <button class="size-btn" data-size="M" onclick="selectSize(this, 'M')">M</button>
            <button class="size-btn" data-size="L" onclick="selectSize(this, 'L')">L</button>
            <button class="size-btn" data-size="XL" onclick="selectSize(this, 'XL')">XL</button>
            <button class="size-btn" data-size="XXL" disabled>XXL<span style="display:block;font-size:10px;color:#c87855;margin-top:2px">Sold Out</span></button>
          </div>
          <div style="color:#6b5d52;font-size:13px;text-align:center">Free returns within 30 days</div>
        </div>

        <button class="cta-btn cta-primary fade-in visible" id="primaryCTA" onclick="handleAddToCart('primary')">
          GET MINE NOW - $59
          <div class="btn-subtitle">Ships Today (Limited Stock)</div>
        </button>

        <button class="cta-btn fade-in visible" id="secondaryCTA" style="background:#faf8f5;color:#4a3728;border:2px solid #4a3728" onclick="handleAddToCart('secondary')">
          PRE-ORDER FOR $19
          <div class="btn-subtitle">Worth the wait: Ships in 2-3 weeks (save $40)</div>
        </button>

        <!-- Guarantee Badge -->
        <div style="background:#f3f7f1;border:2px solid #87a878;border-radius:12px;padding:16px;margin-top:20px;text-align:center">
          <div style="font-weight:700;font-size:16px;color:#87a878;margin-bottom:4px">30-Day Money-Back Guarantee</div>
          <div style="color:#6b5d52;font-size:13px">Don't love it? Return for free. No questions asked.</div>
        </div>

        <div style="display:flex;gap:20px;margin-top:20px;flex-wrap:wrap">
          <div style="display:flex;align-items:center;gap:8px;color:#6b5d52;font-size:14px">
            <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 13l4 4L19 7"/></svg>
            Free Returns
          </div>
          <div style="display:flex;align-items:center;gap:8px;color:#6b5d52;font-size:14px">
            <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 13l4 4L19 7"/></svg>
            Fast Shipping
          </div>
          <div style="display:flex;align-items:center;gap:8px;color:#6b5d52;font-size:14px">
            <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 13l4 4L19 7"/></svg>
            Secure Checkout
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Lazy Content Container -->
  <div id="lazyContent"></div>
</div>

<script>
// Performance Metrics
const perfMetrics = { marks: {}, mark(name) { this.marks[name] = performance.now(); } };
perfMetrics.mark('script-start');

// Initialize on DOM ready (no quiz - direct to product)
document.addEventListener('DOMContentLoaded', function() {
  loadThumbnails();
  loadRemainingContent();
  perfMetrics.mark('content-loaded');

  // XL Scarcity Timer - Sells out after 15 seconds
  setTimeout(() => {
    const xlButton = document.querySelector('[data-size="XL"]');
    if (xlButton && !xlButton.disabled) {
      xlButton.disabled = true;
      xlButton.innerHTML = 'XL<span style="display:block;font-size:10px;color:#c87855;margin-top:2px">Sold Out</span>';
      xlButton.style.opacity = '0.4';
      xlButton.style.cursor = 'not-allowed';
      xlButton.classList.remove('selected');

      // If XL was selected, deselect it
      if (window.selectedSize === 'XL') {
        window.selectedSize = null;
      }

      // Show scarcity popup
      showScarcityPopup();
    }
  }, 15000);
});

// ESC key to close popup
document.addEventListener('keydown', function(e) {
  if (e.key === 'Escape') {
    const popup = document.getElementById('orderBumpPopup');
    if (popup && popup.style.display === 'flex') {
      closeOrderBumpPopup();
    }
  }
});

// Click outside popup to close
document.getElementById('orderBumpPopup')?.addEventListener('click', function(e) {
  if (e.target === this) {
    closeOrderBumpPopup();
  }
});

// Product Images
const productImages = ['product-01.jpeg', 'product-02.jpeg', 'product-03.jpeg', 'product-04.jpeg'];

function loadThumbnails() {
  const thumbsContainer = document.getElementById('thumbs');
  thumbsContainer.innerHTML = '';

  productImages.forEach((src, i) => {
    const thumb = document.createElement('img');
    thumb.src = `./images/product/${src}`;
    thumb.alt = `Product view ${i + 1}`;
    thumb.loading = 'lazy';
    thumb.style.cssText = `width:80px;height:100px;border-radius:8px;cursor:pointer;border:2px solid ${i === 0 ? '#4a3728' : 'transparent'};object-fit:cover;transition:all 0.2s`;
    thumb.onclick = () => switchMainImage(src, thumb);
    thumbsContainer.appendChild(thumb);
  });
}

function switchMainImage(src, thumbElement) {
  const heroImg = document.getElementById('heroImage');
  heroImg.src = `./images/product/${src}`;

  document.querySelectorAll('#thumbs img').forEach(t => t.style.borderColor = 'transparent');
  thumbElement.style.borderColor = '#4a3728';
}

// Size and Cart Functions
window.selectedSize = null;
window.currentOrderType = null;

function selectSize(button, size) {
  document.querySelectorAll('.size-btn').forEach(btn => {
    btn.classList.remove('selected');
    btn.style.background = '#faf8f5';
    btn.style.color = '#2a2420';
    btn.style.borderColor = '#ede8e3';
  });

  button.classList.add('selected');
  button.style.background = '#4a3728';
  button.style.color = '#faf8f5';
  button.style.borderColor = '#4a3728';

  window.selectedSize = size;
}

// Scarcity Popup Function
function showScarcityPopup() {
  const popup = document.getElementById('scarcityPopup');
  if (!popup) return;

  // Show popup with animation
  popup.classList.add('show');

  // Auto-dismiss after 3 seconds
  setTimeout(() => {
    popup.classList.remove('show');
    popup.classList.add('hide');

    // Remove hide class after animation completes
    setTimeout(() => {
      popup.classList.remove('hide');
    }, 400);
  }, 3000);
}

// SimpleSwap Pool Integration
const SIMPLESWAP_POOL_API = '/.netlify/functions';
let requestInFlight = false;  // Race condition protection

async function getExchangeFromPool(amountUSD) {
  if (requestInFlight) {
    console.log('[POOL] Request already in progress');
    return;
  }
  requestInFlight = true;
  try {
    const btn = document.querySelector('.cta-btn.cta-primary');
    const originalText = btn ? btn.innerHTML : '';
    if (btn) btn.innerHTML = 'Creating your order...<div class="btn-subtitle">Please wait</div>';

    const controller = new AbortController();
    const timeoutId = setTimeout(() => controller.abort(), 15000);

    const response = await fetch(`${SIMPLESWAP_POOL_API}/buy-now`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ amountUSD: amountUSD }),
      signal: controller.signal
    });

    clearTimeout(timeoutId);
    const data = await response.json();

    if (data.success && data.exchangeUrl) {
      window.location.href = data.exchangeUrl;
    } else {
      alert('Unable to create order. Please try again.');
      if (btn) btn.innerHTML = originalText;
    }
  } catch (error) {
    console.error('[POOL] Error:', error);
    alert(error.name === 'AbortError' ? 'Request timeout. Please try again.' : 'Payment error. Please try again.');
    // Restore button state on error
    const btn = document.querySelector('.cta-btn.cta-primary');
    if (btn) btn.innerHTML = 'GET MINE NOW - $59<div class="btn-subtitle">Ships Today (Limited Stock)</div>';
  } finally {
    requestInFlight = false;  // Reset race condition flag
  }
}

async function processOrder(amountUSD) {
  if (typeof ttq !== 'undefined') {
    ttq.track('Purchase', {
      content_id: 'seamless-blazer',
      content_type: 'product',
      content_name: 'Seamless Blazer',
      price: amountUSD,
      quantity: 1,
      currency: 'USD',
      value: amountUSD
    });
  }
  await getExchangeFromPool(amountUSD);
}

function handleAddToCart(type) {
  perfMetrics.mark(`cta-clicked-${type}`);
  window.currentOrderType = type;

  if (!window.selectedSize) {
    // Scroll to size selector in product info section
    const sizeButtons = document.querySelectorAll('.size-btn');
    if (sizeButtons.length > 0) {
      sizeButtons[0].parentElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
      sizeButtons[0].parentElement.style.animation = 'pulse 1s ease-in-out';
    }
    alert('Please select a size first');
    return;
  }

  // CRITICAL FIX: Primary button goes DIRECT to checkout, NO POPUP
  if (type === 'primary') {
    processOrder(59);
  } else {
    // Secondary (pre-order) shows popup first
    showOrderBumpPopup(type);
  }
}

function showOrderBumpPopup(type) {
  const basePrice = type === 'primary' ? 59 : 19;
  const bumpPrice = 10;
  const total = basePrice + bumpPrice;

  document.getElementById('orderSummary').innerHTML = `
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
      <span style="color:#6b5d52">${type === 'primary' ? 'Seamless Blazer' : 'Pre-Order: Seamless Blazer'}</span>
      <span style="font-weight:600;color:#2a2420">$${basePrice}</span>
    </div>
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;padding-bottom:12px;border-bottom:1px solid #ede8e3">
      <span style="color:#87a878;font-weight:600">+ Silk Pocket Square</span>
      <span style="font-weight:600;color:#87a878">$${bumpPrice}</span>
    </div>
    <div style="display:flex;justify-content:space-between;align-items:center">
      <span style="font-size:18px;font-weight:700;color:#2a2420">Total</span>
      <span style="font-size:24px;font-weight:700;color:#2a2420">$${total}</span>
    </div>
  `;

  document.getElementById('orderBumpPopup').style.display = 'flex';
  document.body.style.overflow = 'hidden';
}

function closeOrderBumpPopup() {
  document.getElementById('orderBumpPopup').style.display = 'none';
  document.body.style.overflow = 'auto';
}

function acceptOrderBump() {
  closeOrderBumpPopup();
  // API only accepts: 19, 29, 59
  // Primary ($59) + pocket square = use $59 (accessory bonus included)
  // Pre-order ($19) + pocket square = $29 (supported)
  const amount = window.currentOrderType === 'primary' ? 59 : 29;
  processOrder(amount);
}

function declineOrderBump() {
  closeOrderBumpPopup();
  const amount = window.currentOrderType === 'primary' ? 59 : 19;
  processOrder(amount);
}

// SVG Platform Icons
const platformSVGs = {
  tiktok: `<svg viewBox="0 0 24 24" fill="currentColor"><path d="M19.59 6.69a4.83 4.83 0 01-3.77-4.25V2h-3.45v13.67a2.89 2.89 0 01-5.2 1.74 2.89 2.89 0 012.31-4.64 2.93 2.93 0 01.88.13V9.4a6.84 6.84 0 00-1-.05A6.33 6.33 0 005 20.1a6.34 6.34 0 0010.86-4.43v-7a8.16 8.16 0 004.77 1.52v-3.4a4.85 4.85 0 01-1-.1z"/></svg>`,
  instagram: `<svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zM12 0C8.741 0 8.333.014 7.053.072 2.695.272.273 2.69.073 7.052.014 8.333 0 8.741 0 12c0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98C8.333 23.986 8.741 24 12 24c3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98C15.668.014 15.259 0 12 0zm0 5.838a6.162 6.162 0 100 12.324 6.162 6.162 0 000-12.324zM12 16a4 4 0 110-8 4 4 0 010 8zm6.406-11.845a1.44 1.44 0 100 2.881 1.44 1.44 0 000-2.881z"/></svg>`,
  facebook: `<svg viewBox="0 0 24 24" fill="#1877F2"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/></svg>`,
  trustpilot: `<svg viewBox="0 0 24 24" fill="#00b67a"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>`,
  google: `<svg viewBox="0 0 24 24"><path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/><path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/><path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/><path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/></svg>`
};

const platformColors = {
  tiktok: '#000000',
  instagram: '#E4405F',
  facebook: '#1877F2',
  trustpilot: '#00b67a',
  google: '#4285F4'
};

// Testimonial Data - 20 testimonials from agent-1b.json
const testimonials = [
  { name: "Maya Rodriguez", platform: "tiktok", rating: 5, text: "OBSESSED is an understatement!! wore this to a wedding and THREE people asked where i got it. the seamless design is actually insane like no bumpy seams digging into your armpits??? revolutionary. im 5'6 and got a small, fits like it was made for me no cap", date: "1 week ago", img: 1 },
  { name: "Jessica Chen", platform: "tiktok", rating: 5, text: "ok but why does this blazer make me look like i have my life together?? wore it to a job interview and got hired ON THE SPOT. could be coincidence but i choose to believe it was the blazer. the fabric is so buttery smooth omg", date: "4 days ago", img: 2 },
  { name: "Aisha Patel", platform: "tiktok", rating: 5, text: "this blazer is giving EXPENSIVE. wore it on a first date and he thought i was a CEO or something lmaooo. the way it just glides on without any awkward pulling at seams?? chefs kiss. size medium btw im 5'8", date: "1 day ago", img: 3 },
  { name: "Sophie Martin", platform: "tiktok", rating: 4, text: "ngl i was skeptical bc of the price but this blazer ATE. only giving 4 stars bc i wish it came in more colors but the quality is honestly better than my $200 zara one?? make it make sense", date: "3 days ago", img: 4 },
  { name: "Taylor Kim", platform: "tiktok", rating: 5, text: "POV: you found the perfect blazer that doesn't make you look like you're wearing your dads suit. the seamless thing isnt just marketing hype its actually SO comfortable. wore it for 12 hours straight at a conference and forgot i even had it on", date: "2 hours ago", img: 5 },
  { name: "Emma Thompson", platform: "tiktok", rating: 5, text: "this blazer just HITS different. idk how to explain it but you know when something just feels right?? thats this. got so many compliments at brunch yesterday my friends are all ordering one now lol", date: "1 day ago", img: 6 },
  { name: "Zoe Anderson", platform: "tiktok", rating: 4, text: "ok hear me out... this blazer made me feel like THAT girl. wore it to a networking event and suddenly everyone wanted to talk to me?? confidence boost is real. only complaint is i want it in every color now", date: "2 days ago", img: 7 },
  { name: "Mia Santos", platform: "tiktok", rating: 5, text: "NOT me wearing this blazer three times this week already. its become my personality at this point. the seamless design means no weird lumps under thin shirts and it just looks so CLEAN. im a size large usually got XL for oversized fit and its perfect", date: "5 hours ago", img: 8 },
  { name: "Isabella Rose", platform: "instagram", rating: 5, text: "Elevating my workwear capsule with this stunning piece. The seamless construction creates such a clean, sophisticated silhouette - perfect for those days when you need to look polished effortlessly. Paired it with vintage Levis and my favorite Mejuri hoops for that high-low mix I'm obsessed with lately.", date: "6 days ago", img: 9 },
  { name: "Olivia Grace", platform: "instagram", rating: 5, text: "Investment piece vibes at a fraction of the cost. The quality is genuinely impressive - you can tell in the weight of the fabric and the way it drapes. Been styling it over slip dresses for evening, with tailored pants for work, and even over workout sets for coffee runs. Versatility is everything.", date: "4 days ago", img: 10 },
  { name: "Natalie Brooks", platform: "instagram", rating: 4, text: "The aesthetic is immaculate. That seamless finish gives it such a modern, architectural feel. I'm 5'5 and the proportions are spot-on - hits right at the hip for that perfectly oversized-but-tailored look. Only wish it came in a camel color for fall!", date: "2 days ago", img: 11 },
  { name: "Aria Monroe", platform: "instagram", rating: 5, text: "This blazer understood the assignment. Wore it to an art gallery opening and felt like I belonged in the exhibition. The seamless design is so editorial - photographs beautifully. Already planning my next three outfits around it.", date: "1 day ago", img: 12 },
  { name: "Luna Hayes", platform: "instagram", rating: 5, text: "When a blazer makes you want to plan events just so you have an excuse to wear it. The fit is chef's kiss - structured enough to look intentional, comfortable enough to wear all day. Been living in mine since it arrived last week.", date: "3 days ago", img: 13 },
  { name: "Jennifer Morrison", platform: "facebook", rating: 5, text: "I purchased this blazer after seeing it recommended in a professional women's group and I'm so glad I did. At 52, I've bought my share of blazers and this one truly stands out. The seamless construction means no irritating seams rubbing throughout the day, which is so important when you're wearing something for 8+ hours. I wore it to my daughter's college graduation and got compliments from other moms. The quality far exceeds the price point - I paid more for blazers at Macy's that didn't fit half as well. Ordered a medium (I'm 5'4, 145lbs) and it fits perfectly.", date: "1 week ago", img: 14 },
  { name: "Patricia Chen", platform: "facebook", rating: 4, text: "Really impressed with this purchase. I teach high school and needed something professional but not stuffy. This blazer is perfect - the students even commented that I looked nice, which believe me, doesn't happen often! The seamless design is actually noticable - it just lays flat and smooth, no bunching. My only minor complaint is that I wish the pockets were a tiny bit deeper, but honestly that's such a small thing. Would absolutely recommend to other teachers or anyone who needs to look professional on a budget.", date: "2 weeks ago", img: 1 },
  { name: "Rebecca Williams", platform: "facebook", rating: 5, text: "This is my third blazer purchase from this style and I keep coming back because the quality is consistently excellent. I work in real estate and presentation matters. This blazer makes me look successful and put-together, which is exactly what you want when meeting clients. The fabric doesn't wrinkle easily even after sitting in the car, and the seamless construction means it photographs well for my listings. I'm 5'9 and ordered a large - fits beautifully with room for a blouse underneath.", date: "2 weeks ago", img: 2 },
  { name: "Michelle Davis", platform: "facebook", rating: 3, text: "It's a nice blazer for the price. The seamless thing is neat but I'm not sure it makes a huge difference for me personally. That said, it does look professional and I've gotten use out of it for work meetings. Fits true to size (I'm a medium, 5'6). Would have liked a bit more structure in the shoulders but overall it's decent value for money.", date: "3 weeks ago", img: 3 },
  { name: "Amanda Foster", platform: "trustpilot", rating: 5, text: "Exceptional quality and craftsmanship for this price point. I've been in corporate law for 15 years and have purchased blazers ranging from $100 to $800+. While this isn't luxury tier, it performs remarkably well for professional settings. The seamless construction is genuinely innovative - eliminates the common issue of visible seam lines under fitted shirts. Fabric has a nice weight (not flimsy), tailoring is precise, and the cut is modern without being trendy. Wore it to court three times this month and it holds up beautifully. Shipping was prompt, packaging was professional. Would purchase again and have recommended to colleagues.", date: "3 weeks ago", img: 4 },
  { name: "Dr Sarah Mitchell", platform: "trustpilot", rating: 4, text: "Very pleased with this purchase overall. As a university professor, I need professional attire that's also comfortable for long teaching days. This blazer delivers on both fronts. The seamless design is noticeably more comfortable than traditional blazers - no seams digging in when I'm writing on the board or sitting at my desk. Fabric quality is good, stitching appears durable. One minor observation: the black isn't quite as deep as I expected from the photos, it's more of a true black than a rich black. Still very wearable and professional. Size small fit perfectly (I'm 5'3, 125lbs).", date: "4 weeks ago", img: 5 },
  { name: "David Park", platform: "google", rating: 5, text: "Great blazer, exactly as described. Fits well and looks expensive. Shipping was fast. Would buy again.", date: "4 weeks ago", img: 6 }
];

// Load Remaining Content
function loadRemainingContent() {
  const lazyContent = document.getElementById('lazyContent');

  lazyContent.innerHTML = `
    <!-- Product Details - ACCORDION VERSION -->
    <div class="fade-in" style="padding:40px 20px;background:#f5f3f0;max-width:800px;margin:0 auto">
      <h2 style="text-align:center;font-size:28px;font-weight:700;margin-bottom:30px;color:#2a2420">The Details</h2>
      <div style="background:#faf8f5;border-radius:12px;box-shadow:0 2px 12px rgba(74,55,40,0.06);padding:0 24px">

        <div class="accordion-item">
          <button class="accordion-header" onclick="toggleAccordion(this)">
            <span>Fit & Style</span>
            <span class="accordion-icon">▼</span>
          </button>
          <div class="accordion-content">
            <ul style="color:#6b5d52;font-size:15px;line-height:1.8;list-style:none;padding:0">
              <li style="margin:8px 0">✓ Seamless construction - no awkward seams</li>
              <li style="margin:8px 0">✓ Professional tailored fit</li>
              <li style="margin:8px 0">✓ Modern architectural silhouette</li>
              <li style="margin:8px 0">✓ Structured yet comfortable</li>
            </ul>
          </div>
        </div>

        <div class="accordion-item">
          <button class="accordion-header" onclick="toggleAccordion(this)">
            <span>Fabric & Care</span>
            <span class="accordion-icon">▼</span>
          </button>
          <div class="accordion-content">
            <ul style="color:#6b5d52;font-size:15px;line-height:1.8;list-style:none;padding:0">
              <li style="margin:8px 0">✓ Buttery-smooth premium fabric</li>
              <li style="margin:8px 0">✓ Professional navy colorway</li>
              <li style="margin:8px 0">✓ Wrinkle-resistant material</li>
              <li style="margin:8px 0">✓ Dry clean or gentle hand wash</li>
            </ul>
          </div>
        </div>

        <div class="accordion-item" style="border-bottom:none">
          <button class="accordion-header" onclick="toggleAccordion(this)">
            <span>Styling Tips</span>
            <span class="accordion-icon">▼</span>
          </button>
          <div class="accordion-content">
            <ul style="color:#6b5d52;font-size:15px;line-height:1.8;list-style:none;padding:0">
              <li style="margin:8px 0">✓ Pair with tailored pants for boardroom ready</li>
              <li style="margin:8px 0">✓ Style over slip dress for evening events</li>
              <li style="margin:8px 0">✓ Casual with vintage denim</li>
              <li style="margin:8px 0">✓ Add silk pocket square to elevate</li>
            </ul>
          </div>
        </div>

      </div>
    </div>

    <!-- Why Choose Section - PREMIUM SVG ICONS -->
    <div class="fade-in" style="padding:60px 20px;max-width:1200px;margin:0 auto">
      <h2 style="text-align:center;font-size:28px;font-weight:700;margin-bottom:40px;color:#2a2420">Why Everyone's Obsessed</h2>
      <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(min(100%,250px),1fr));gap:30px">

        <div style="text-align:center;padding:30px">
          <svg width="56" height="56" viewBox="0 0 24 24" fill="none" stroke="#4a3728" stroke-width="1.5" style="margin:0 auto 20px">
            <path d="M12 2L2 7l10 5 10-5-10-5z"/>
            <path d="M2 17l10 5 10-5"/>
            <path d="M2 12l10 5 10-5"/>
          </svg>
          <h3 style="margin-bottom:15px;font-weight:600;font-size:18px;color:#2a2420">Seamless Perfection</h3>
          <p style="color:#6b5d52;font-size:14px;line-height:1.6">No awkward seams digging in - just buttery smooth comfort all day long</p>
        </div>

        <div style="text-align:center;padding:30px">
          <svg width="56" height="56" viewBox="0 0 24 24" fill="none" stroke="#4a3728" stroke-width="1.5" style="margin:0 auto 20px">
            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
            <line x1="16" y1="2" x2="16" y2="6"/>
            <line x1="8" y1="2" x2="8" y2="6"/>
            <line x1="3" y1="10" x2="21" y2="10"/>
            <path d="M8 14h.01M12 14h.01M16 14h.01M8 18h.01M12 18h.01M16 18h.01"/>
          </svg>
          <h3 style="margin-bottom:15px;font-weight:600;font-size:18px;color:#2a2420">Professional Style</h3>
          <p style="color:#6b5d52;font-size:14px;line-height:1.6">Clean, sophisticated silhouette that commands respect in any room</p>
        </div>

        <div style="text-align:center;padding:30px">
          <svg width="56" height="56" viewBox="0 0 24 24" fill="none" stroke="#4a3728" stroke-width="1.5" style="margin:0 auto 20px">
            <circle cx="12" cy="12" r="10"/>
            <polyline points="12 6 12 12 16 14"/>
          </svg>
          <h3 style="margin-bottom:15px;font-weight:600;font-size:18px;color:#2a2420">Versatile Design</h3>
          <p style="color:#6b5d52;font-size:14px;line-height:1.6">From boardroom to brunch - one blazer, infinite styling possibilities</p>
        </div>

      </div>
    </div>

    <!-- Testimonials Section -->
    <div class="fade-in" style="padding:60px 20px;background:#f5f3f0">
      <div style="max-width:1200px;margin:0 auto">
        <h2 style="text-align:center;font-size:28px;font-weight:700;margin-bottom:16px;color:#2a2420">Real Reviews</h2>
        <p style="text-align:center;color:#6b5d52;margin-bottom:40px">See what people are saying about this blazer</p>

        <div id="testimonialGrid" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(min(100%,350px),1fr));gap:24px">
          ${renderTestimonials(10)}
        </div>

        <div style="text-align:center;margin-top:40px">
          <button id="loadMoreBtn" onclick="loadMoreReviews()" style="background:#4a3728;color:#faf8f5;border:none;padding:16px 40px;border-radius:12px;font-weight:600;cursor:pointer;transition:all 0.2s">
            Load More Reviews
          </button>
        </div>
      </div>
    </div>

    <!-- Final CTA -->
    <div class="fade-in" style="padding:80px 20px;text-align:center;background:linear-gradient(135deg,#4a3728 0%,#5d4a3a 100%);color:#faf8f5">
      <h2 style="font-size:clamp(28px,5vw,40px);font-weight:700;margin-bottom:16px">Don't Miss Out</h2>
      <p style="font-size:18px;opacity:0.9;margin-bottom:30px;max-width:500px;margin-left:auto;margin-right:auto">This blazer sold out 3x already. Get yours before they're gone again.</p>
      <button onclick="document.querySelector('.product-hero').scrollIntoView({behavior:'smooth'})" style="background:#faf8f5;color:#4a3728;border:none;padding:18px 50px;border-radius:12px;font-size:18px;font-weight:700;cursor:pointer;transition:all 0.2s">
        Get Yours Now
      </button>
    </div>
  `;

  // Animate elements
  requestAnimationFrame(() => {
    document.querySelectorAll('.fade-in').forEach((el, i) => {
      setTimeout(() => el.classList.add('visible'), i * 100);
    });
  });
}

function renderTestimonials(count) {
  return testimonials.slice(0, count).map(t => `
    <div class="testimonial-card">
      <div class="testimonial-header">
        <img src="./images/testimonials/testimonial-${String(t.img).padStart(2, '0')}.jpeg" alt="${t.name}" class="testimonial-avatar" loading="lazy">
        <div class="testimonial-info">
          <div class="testimonial-name">${t.name}</div>
          <div class="testimonial-platform" style="color:${platformColors[t.platform]}">
            ${platformSVGs[t.platform]}
            <span>Verified on ${t.platform.charAt(0).toUpperCase() + t.platform.slice(1)}</span>
          </div>
        </div>
        <div class="testimonial-stars">${'★'.repeat(t.rating)}${'☆'.repeat(5-t.rating)}</div>
      </div>
      <p class="testimonial-text">${t.text}</p>
      <div class="testimonial-date">${t.date}</div>
      <img src="./images/testimonials/testimonial-${String(t.img).padStart(2, '0')}.jpeg" alt="${t.name} wearing the blazer" class="testimonial-photo" loading="lazy">
    </div>
  `).join('');
}

let reviewsLoaded = 10;
function loadMoreReviews() {
  const grid = document.getElementById('testimonialGrid');
  const remaining = testimonials.slice(reviewsLoaded);

  remaining.forEach((t, i) => {
    const card = document.createElement('div');
    card.className = 'testimonial-card';
    card.style.opacity = '0';
    card.style.transform = 'translateY(20px)';
    card.innerHTML = `
      <div class="testimonial-header">
        <img src="./images/testimonials/testimonial-${String(t.img).padStart(2, '0')}.jpeg" alt="${t.name}" class="testimonial-avatar" loading="lazy">
        <div class="testimonial-info">
          <div class="testimonial-name">${t.name}</div>
          <div class="testimonial-platform" style="color:${platformColors[t.platform]}">
            ${platformSVGs[t.platform]}
            <span>Verified on ${t.platform.charAt(0).toUpperCase() + t.platform.slice(1)}</span>
          </div>
        </div>
        <div class="testimonial-stars">${'★'.repeat(t.rating)}${'☆'.repeat(5-t.rating)}</div>
      </div>
      <p class="testimonial-text">${t.text}</p>
      <div class="testimonial-date">${t.date}</div>
      <img src="./images/testimonials/testimonial-${String(t.img).padStart(2, '0')}.jpeg" alt="${t.name} wearing the blazer" class="testimonial-photo" loading="lazy">
    `;
    grid.appendChild(card);

    setTimeout(() => {
      card.style.transition = 'all 0.4s ease';
      card.style.opacity = '1';
      card.style.transform = 'translateY(0)';
    }, i * 50);
  });

  reviewsLoaded = testimonials.length;
  document.getElementById('loadMoreBtn').style.display = 'none';
}

// Accordion toggle function
function toggleAccordion(header) {
  const content = header.nextElementSibling;
  const isActive = header.classList.contains('active');

  // Close all accordions
  document.querySelectorAll('.accordion-header').forEach(h => {
    h.classList.remove('active');
    h.nextElementSibling.classList.remove('active');
  });

  // Open clicked accordion if it wasn't active
  if (!isActive) {
    header.classList.add('active');
    content.classList.add('active');
  }
}

// Initialize on load
window.addEventListener('load', () => {
  perfMetrics.mark('window-loaded');
  console.log('Performance Metrics:', perfMetrics.marks);

  // Register Service Worker for caching
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('/sw.js')
      .then(reg => console.log('SW registered:', reg.scope))
      .catch(err => console.log('SW registration skipped'));
  }
});
</script>

</body>
</html>
